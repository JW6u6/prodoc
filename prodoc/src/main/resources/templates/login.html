<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<link href="/css/toggleClass.css" rel="stylesheet" />
</head>
<!-- 해야 할 목록
■ 회원가입 이메일
■ 로그인: java -> 비밀번호 암호화-비교
■ 로그인 (1)이메일
□ 로그인 (2)카카오 연동
□ 아이디 / 비밀번호 찾기
□ css
 -->
<body>
	<!-- 로그인 영역 -->
    <div>
        <div>
	        <div>
	        	<form method="post"	action="/login" >
	            <input type="text" id="email" name="email" value="user1@user1"><br>
	            <input type="password" id="password" name="password" value="1234"><br>
	            <button type="submit" id="loginBtn">로그인</button>
	            <button type="button" id="joinBtn">회원가입</button><br>
	            <button type="button" id="kakaoBtn" style="background-color:#FEE500; width:150px; height:auth; border:0px; padding:5px; margin:3px;">카카오 로그인</button>
	        	</form>
		        <p id="failMsg" th:text="${errorMsg}" style="color:red;"></p>
	        </div>
            <p id="find" style="color:gray;">이메일/비밀번호 찾기</p>
        </div>
        <div><!-- prodoc 로고 이미지 --><img src=""></div>
    </div>

	<!--아이디비번찾기 모달창-->
 	<div id="findUserInfo" style="border:1px solid black" class="hide">
 		<div><button class="closeBtn">&#10005;</button></div>
 		
        <button type="button" class="findBtn">Email찾기</button>
        <button type="button" class="findBtn">PW찾기</button>

        <!--이메일 찾기-->
        <div id="findEmail">
        	<label>이메일</label><input name="email" id="emailMd" placeholder="EMAIL 입력" disabled><br>
            
            <label>전화번호</label><input name="phone" id="phoneMd" placeholder="-없이 연락처 입력">
            <button type="button" id="AuthBtn">인증번호 받기</button><br>
        	
        	<label>인증번호</label><input id="authInput" placeholder="인증번호">
        	<button type="button" class="authCheck">확인</button><br>
            
            <p id="showEmail" style="display:none"></p>
            
	        <div id="findPW" class="hide">
	            <label>비밀번호</label><input name="newPW" placeholder="새 비밀번호" disabled><br>
		        <label>비밀번호 확인</label><input id="newPWCheck" placeholder="비밀번호 확인" disabled>
	        </div>        
        </div>
        
        <!--비밀번호 찾기-->

        <button type="button" id="closeFind">확인</button>
    </div>


<script src="js/modal/close.js"></script>
<script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
<script>
//아이디, 비밀번호 찾기
let findMd = document.getElementById("findUserInfo"); //모달창 

document.getElementById("find")	//p태그 <-버튼효과
.addEventListener('click', function(e){
	if(findMd.className == 'view'){
		findMd.className = 'hide';
	}else{		
		findMd.className = 'view';
	}
});

//번호 입력 칸에 문자 입력(찾기 창 속)
let phoneNumber = document.querySelector('input[name="phone"]');
phoneNumber.addEventListener('input', (e)=> phoneNumber.value =
					 phoneNumber.value.replace(/[^0-9]/gi, ""));

//찾기 창 내 토글 버튼
let emailType = document.querySelector("#findEmail");	//이메일 찾기
let pwType = document.querySelector("#findPW") 			//비밀번호 찾기

document.querySelectorAll(".findBtn").forEach((tag,idx) => {	
	tag.addEventListener('click', function(e){
		if(idx == 0){	//아이디 찾기
			emailType.className = "view";
			pwType.className = "hide";
		}else{			//비밀번호 찾기
			emailType.className = "hide";
			pwType.className = "view";
		}
	});
});

function findEmailFnc(){
	//id="phone" id="phoneAuth" name="authInput" class="authCheck" id="showEmail"
}

function findPassFnc(){
	//id="emailMd" id="emailAuth" name="authInput" class="authCheck"  name="newPW" id="newPWCheck"
}

//확인 창
document.querySelector("#closeFind").addEventListener('click', function(e){
	//1) 이메일 확인 후 닫기
	//2) 비밀번호 변경 ajax 처리 후 닫기
});

//회원가입 버튼
document.getElementById("joinBtn")
.addEventListener('click', function(e){	
	document.location.href = "/join"
});


//카카오로그인
window.Kakao.init("250e6ec18ab563f59e7bf3d2479ad0e7");
let kakaoBtn = document.getElementById("kakaoBtn");

kakaoBtn.addEventListener('click', function(e){
	window.Kakao.Auth.login({
		scope: 'profile_nickname, profile_image, account_email, birthday',	//로그인 시 받아오는 정보 변수	
		success : function(user){
			console.log(user);
			window.Kakao.API.request({
				url: '/v2/user/me',
				success: res =>{
					const kakao_account = res.kakao_account;
					console.log(kakao_account);
					//DB 저장 -> 이메일 체크
				}
			});
		}
	});
});

</script>
</body>
</html>