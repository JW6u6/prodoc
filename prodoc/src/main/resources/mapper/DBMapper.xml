<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.prodoc.db.mapper.DBMapper">
	<!-- DBCase 페이지 추가 -->
	<insert id="insertDBCase" parameterType="DBCaseVO" statementType="CALLABLE">
		{call INSERT_DB(
						#{wordId}
						, #{email}
						, #{prentPage}
						, #{displayId}
						, #{result}
		)}
	</insert>
	
	<!-- DB속성 페이지 추가 -->
	<insert id="insertDBPage" parameterType="DBdataVO" statementType="CALLABLE">
		{call INSERT_DB_PAGE(
							#{parentBlockId}
							, #{displayId}
							, #{email}
							, #{state}
							, #{result, mode=OUT, jdbcType=VARCHAR, javaType=String}
		)}
	</insert>

	<!-- DBCase페이지로 하위 페이지(블럭) 리스트 조회 -->	
	<select id="getDBPageList" resultType="BlockVO" parameterType="String">
		SELECT *
		FROM tbl_display
		WHERE page_id = (SELECT page_id
		                FROM tbl_dbblock
		                WHERE display_id = #{dbBlockID})
		ORDER BY row_x
	</select>
	
	<!-- displayId로 DB 페이지 조회 -->
	<select id="getDBPageInfo" resultType="PageVO" parameterType="String">
		SELECT *
		FROM tbl_page
		WHERE page_id = ( SELECT page_id
                          FROM tbl_dbblock
                          WHERE display_id = #{displayId})
	</select>
	
	<!-- DB 레이아웃 변경 -->
	<update id="updateCase" parameterType="PageVO">
		UPDATE tbl_page
		SET case_id = #{caseId}
		WHERE page_id = #{pageId}
	</update>

</mapper>